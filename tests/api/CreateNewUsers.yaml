description: Registers new users and validates the response
dataSet: $data("newUsers")
actors:
  - actor: ACTOR1
    segments:
      - segment: 1
        actions:
          - description: Send a request to register a new user
            action: org.getopentest.actions.HttpRequest
            args:
              url: https://reqres.in/api/users
              headers:
                Content-Type: application/json
              verb: POST
              body: |
                $json(
                  {
                    name: $dataRecord.name,
                    job: $dataRecord.job
                  }
                )
              $localData:
                statusCode: $output.statusCode
                postInfo: $output.body

          - description: Validate the response status code
            macro: VerifyValue
            args:
              valueTitle: "response status code"
              valueToVerify: $localData.statusCode
              expectedValue: 201

          - description: Validate the user name
            macro: VerifyValue
            args:
              valueTitle: "user name"
              valueToVerify: $localData.postInfo.name
              expectedValue: $dataRecord.name

          - description: Validate the user job
            macro: VerifyValue
            args:
              valueTitle: "user job"
              valueToVerify: $localData.postInfo.job
              expectedValue: $dataRecord.job
